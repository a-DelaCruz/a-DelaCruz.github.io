<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.4.3">Jekyll</generator><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/" rel="alternate" type="text/html" /><updated>2017-06-27T00:47:35+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/</id><title type="html">My Notes on Single Board Computer</title><subtitle>Raspberry Pi 3 - 64-Bit kernel and arm64 rootfs
</subtitle><entry><title type="html">Raspberry Pi 3: simple GPIO on .Net Core inside Docker using bcm2835 library</title><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/26/dotnet-rpi3-gpio.html" rel="alternate" type="text/html" title="Raspberry Pi 3: simple GPIO on .Net Core inside Docker using bcm2835 library" /><published>2017-06-26T00:00:00+08:00</published><updated>2017-06-26T00:00:00+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/26/dotnet-rpi3-gpio</id><content type="html" xml:base="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/26/dotnet-rpi3-gpio.html">&lt;p&gt;I wan’t to try .Net Core on linux-arm64… but unfortunately, there’s no available yet except Win-arm64 and linux-arm32. So instead of using qemu for VM inside RPi3… i encounter docker and try it out. For now i’ll use ubuntu-arm32 as the base image then later try alpine-linux.&lt;/p&gt;

&lt;h4 id=&quot;prerequisites&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;Prerequisites:&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/dotnet/core-setup/files/716356/dotnet-ubuntu.16.04-arm.1.2.0-beta-001291-00.tar.gz&quot;&gt;dotnet-runtime-latest-linux-arm.tar.gz&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.airspayce.com/mikem/bcm2835/bcm2835-1.52.tar.gz&quot;&gt;bcm2835-1.52.tar.gz&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;.Net Core SDK   // on your developtment host&lt;/li&gt;
  &lt;li&gt;libbcm2835.so   // We’ll create from bcm2835-library&lt;/li&gt;
  &lt;li&gt;docker.io       // To be installed on our RPi3&lt;/li&gt;
  &lt;li&gt;make            // To be installed inside docker&lt;/li&gt;
  &lt;li&gt;gcc             // To be installed inside docker&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;###Docker Container
Assuming you already install &lt;code class=&quot;highlighter-rouge&quot;&gt;docker.io&lt;/code&gt;. Go ahead and pull an armhf/ubuntu image to be use.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo docker pull armhf/ubuntu     //This is what i use for now
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then run it using these command:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo docker run -it --privileged -p 5000:5000 -v /home/user:/home/share armhf/ubuntu
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;#####Note: Docker options that we’’ use&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--t
-v  /[folder to share]:/[folder destination]
-p  5000:5000   //port to expose. [any port you like on host]:[any port you'll set on .net core]
--privileged    //to have acces on /dev/mem
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then install these packages for .Net Core:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# apt-get install libunwind8 libunwind8-dev gettext libicu-dev liblttng-ust-dev libcurl4-openssl-dev libssl-dev uuid-dev
# apt-get install make gcc      // can be remove after we created our libbcm2835.so
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;We’re going to extract &lt;code class=&quot;highlighter-rouge&quot;&gt;dotnet-runtime-latest-linux-arm.tar.gz&lt;/code&gt; in /opt/dotnet.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /opt/dotnet
# tar -zxvf dotnet-runtime-latest-linux-arm.tar.gz -C /opt
# /opt/dotnet/dotnet    //Then run this to check that it works. or ./dotnet inside the dotnet folder
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Extract &lt;code class=&quot;highlighter-rouge&quot;&gt;bcm2835-1.52.tar.gz&lt;/code&gt; anywhere you like, because where going to remove it once we have libbcm2835.so&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# tar -zxvf bcm2835-1.52.tar.gz
# cd bcm2835-1.52/src
# gcc -fPIC -c bcm2835.c
# gcc -shared bcm2835.o -o libbcm2835.so
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;You can now remove the bcm2835-1.52 folder and be sure to put libbcm2835.so inside &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/arm-&lt;/code&gt; folder.
And now lets exit docker and save our updated docker image.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# exit
$ sudo docker commit $(sudo docker ps -aq) armhf/ubuntu     // # sudo docker ps -aq get the id of the docker image we just exited.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Reference:
https://dotnetcorechris.github.io/dotnetcoreonraspberrypi.html
http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html&lt;/p&gt;</content><author><name></name></author><category term="ubuntu" /><summary type="html">I wan’t to try .Net Core on linux-arm64… but unfortunately, there’s no available yet except Win-arm64 and linux-arm32. So instead of using qemu for VM inside RPi3… i encounter docker and try it out. For now i’ll use ubuntu-arm32 as the base image then later try alpine-linux. Prerequisites: dotnet-runtime-latest-linux-arm.tar.gz bcm2835-1.52.tar.gz .Net Core SDK // on your developtment host libbcm2835.so // We’ll create from bcm2835-library docker.io // To be installed on our RPi3 make // To be installed inside docker gcc // To be installed inside docker ###Docker Container Assuming you already install docker.io. Go ahead and pull an armhf/ubuntu image to be use. $ sudo docker pull armhf/ubuntu //This is what i use for now Then run it using these command: $ sudo docker run -it --privileged -p 5000:5000 -v /home/user:/home/share armhf/ubuntu #####Note: Docker options that we’’ use --t -v /[folder to share]:/[folder destination] -p 5000:5000 //port to expose. [any port you like on host]:[any port you'll set on .net core] --privileged //to have acces on /dev/mem Then install these packages for .Net Core: # apt-get install libunwind8 libunwind8-dev gettext libicu-dev liblttng-ust-dev libcurl4-openssl-dev libssl-dev uuid-dev # apt-get install make gcc // can be remove after we created our libbcm2835.so We’re going to extract dotnet-runtime-latest-linux-arm.tar.gz in /opt/dotnet. # mkdir /opt/dotnet # tar -zxvf dotnet-runtime-latest-linux-arm.tar.gz -C /opt # /opt/dotnet/dotnet //Then run this to check that it works. or ./dotnet inside the dotnet folder Extract bcm2835-1.52.tar.gz anywhere you like, because where going to remove it once we have libbcm2835.so # tar -zxvf bcm2835-1.52.tar.gz # cd bcm2835-1.52/src # gcc -fPIC -c bcm2835.c # gcc -shared bcm2835.o -o libbcm2835.so You can now remove the bcm2835-1.52 folder and be sure to put libbcm2835.so inside /lib/arm- folder. And now lets exit docker and save our updated docker image. # exit $ sudo docker commit $(sudo docker ps -aq) armhf/ubuntu // # sudo docker ps -aq get the id of the docker image we just exited. Reference: https://dotnetcorechris.github.io/dotnetcoreonraspberrypi.html http://www.yolinux.com/TUTORIALS/LibraryArchives-StaticAndDynamic.html</summary></entry><entry><title type="html">Raspberry Pi 3: Bluetooth Setup</title><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/16/rpi3-bluetooth-setup.html" rel="alternate" type="text/html" title="Raspberry Pi 3: Bluetooth Setup" /><published>2017-06-16T00:00:00+08:00</published><updated>2017-06-16T00:00:00+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/16/rpi3-bluetooth-setup</id><content type="html" xml:base="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/06/16/rpi3-bluetooth-setup.html">&lt;p&gt;In order for the Bluetooth to work.. we need to have this file.&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/OpenELEC/misc-firmware/blob/master/firmware/brcm/BCM43430A1.hcd&quot;&gt;BCM43430A1.hcd&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Make sure this are installed:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;bluetooth&lt;/li&gt;
  &lt;li&gt;bluez&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Put this file: &lt;code class=&quot;highlighter-rouge&quot;&gt;BCM43430A1.hcd&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/firmware/brcm&lt;/code&gt; folder… then create a symlink of it in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/firmware&lt;/code&gt; folder.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mkdir /etc/firmware
$ sudo ln -s /lib/firmware/brcm/BCM43430A1.hcd /etc/firmware/BCM43430A1.hcd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then to test it.. run this twice:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo /usr/bin/hciattach /dev/ttyAMA0 bc43xx 921600 noflow
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;First run we’ll encouter &lt;code class=&quot;highlighter-rouge&quot;&gt;Initialization timed out&lt;/code&gt;. But on the second time we’ll get this &lt;code class=&quot;highlighter-rouge&quot;&gt;Device setup complete&lt;/code&gt;.
Then try it out now if our device is present.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ hcitool dev

    Devices:
        hci0   [your device id shows here]
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then run your friendly &lt;code class=&quot;highlighter-rouge&quot;&gt;bluetoothctl&lt;/code&gt;. To automate this at boot, just follow the scripts from the reference below.&lt;/p&gt;

&lt;h5 id=&quot;reference&quot;&gt;Reference:&lt;/h5&gt;
&lt;ul&gt;
  &lt;li&gt;http://www.adelpha.be/blog/index.php/2016/09/24/raspberry-pi-3-native-wifi-and-bluetooth/&lt;/li&gt;
  &lt;li&gt;https://github.com/xbianonpi/xbian/issues/813&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;</content><author><name></name></author><category term="ubuntu" /><summary type="html">In order for the Bluetooth to work.. we need to have this file. BCM43430A1.hcd Make sure this are installed: bluetooth bluez Put this file: BCM43430A1.hcd in /lib/firmware/brcm folder… then create a symlink of it in /etc/firmware folder. $ sudo mkdir /etc/firmware $ sudo ln -s /lib/firmware/brcm/BCM43430A1.hcd /etc/firmware/BCM43430A1.hcd Then to test it.. run this twice: $ sudo /usr/bin/hciattach /dev/ttyAMA0 bc43xx 921600 noflow First run we’ll encouter Initialization timed out. But on the second time we’ll get this Device setup complete. Then try it out now if our device is present. $ hcitool dev Devices: hci0 [your device id shows here] Then run your friendly bluetoothctl. To automate this at boot, just follow the scripts from the reference below. Reference: http://www.adelpha.be/blog/index.php/2016/09/24/raspberry-pi-3-native-wifi-and-bluetooth/ https://github.com/xbianonpi/xbian/issues/813</summary></entry><entry><title type="html">Raspberry Pi 3: Wifi Setup</title><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/17/rpi3-wifi-setup.html" rel="alternate" type="text/html" title="Raspberry Pi 3: Wifi Setup" /><published>2017-05-17T00:00:00+08:00</published><updated>2017-05-17T00:00:00+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/17/rpi3-wifi-setup</id><content type="html" xml:base="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/17/rpi3-wifi-setup.html">&lt;p&gt;To make the Raspberry pi 3 Wifi to work…we need to get or have atleast 2 files. But first we must create a
folder inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/firmware/&lt;/code&gt; and name it &lt;code class=&quot;highlighter-rouge&quot;&gt;brcm&lt;/code&gt;. And in that folder we’ll put
&lt;code class=&quot;highlighter-rouge&quot;&gt;brcmfmac43430-sdio.bin&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;brcmfmac43430-sdio.txt&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&quot;prerequisite&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;Prerequisite:&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/RPi-Distro/firmware-nonfree/tree/master/brcm80211/brcm&quot;&gt;brcmfmac43430-sdio.bin&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/RPi-Distro/firmware-nonfree/tree/master/brcm80211/brcm&quot;&gt;brcmfmac43430-sdio.txt&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;wpa-supplicant&lt;/li&gt;
  &lt;li&gt;wireless-tools&lt;/li&gt;
&lt;/ul&gt;

&lt;!--more--&gt;
&lt;p&gt;Download and place the &lt;code class=&quot;highlighter-rouge&quot;&gt;brcmfmac43430-sdio.bin&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;brcmfmac43430-sdio.txt&lt;/code&gt; inside the &lt;code class=&quot;highlighter-rouge&quot;&gt;/lib/firmware/brcm&lt;/code&gt; folder.
If the file above doesn’t make your wifi to work get it directly from the Mainstream linux: &lt;a href=&quot;git://git.kernel.org/pub/scm/linux/kernel/git/firmware/linux-firmware.git&quot;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Next we’ll modify &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/network/interfaces&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo nano /etc/network/interfaces
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;And place this following lines:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;allow-hotplug wlan0
iface wlan0 inet dhcp
wpa-conf /etc/wpa_supplicant/wpa_supplicant.conf
iface default inet dhcp
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;For this setup my wifi interfaces id &lt;code class=&quot;highlighter-rouge&quot;&gt;wlan0&lt;/code&gt;… yours might be named differently so replace it
that matches yours.
You can set your wifi to static…just browse the references at the bottom of this page..&lt;/p&gt;

&lt;p&gt;Then we’ll configure &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/wpa_supplicant/wpa_supplicant.conf&lt;/code&gt; … so create/edit the file &lt;code class=&quot;highlighter-rouge&quot;&gt;wpa_supplicant.conf&lt;/code&gt; and place this lines:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;network={
    ssid=&quot;NetworkEssid&quot;
    scan_ssid=1 # only needed if your access point uses a hidden ssid
    proto=RSN
    key_mgmt=WPA-PSK
    psk=&quot;NetworkPassword&quot;
	pairwise=CCMP
	auth_alg=OPEN
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Reboot and verify that wifi is now working and connected to the network.
or you could try this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo ifconfig wlan0 down
$ sudo ifconfig wlan0 up
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h5 id=&quot;reference&quot;&gt;&lt;a href=&quot;#header-5&quot;&gt;&lt;/a&gt;Reference:&lt;/h5&gt;
&lt;ul&gt;
  &lt;li&gt;https://github.com/RPi-Distro/firmware-nonfree/tree/master/brcm80211/brcm&lt;/li&gt;
  &lt;li&gt;https://help.ubuntu.com/community/WifiDocs/WPAHowTo&lt;/li&gt;
  &lt;li&gt;https://w1.fi/cgit/hostap/plain/wpa_supplicant/wpa_supplicant.conf&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;</content><author><name></name></author><category term="ubuntu" /><summary type="html">To make the Raspberry pi 3 Wifi to work…we need to get or have atleast 2 files. But first we must create a folder inside the /lib/firmware/ and name it brcm. And in that folder we’ll put brcmfmac43430-sdio.bin and brcmfmac43430-sdio.txt. Prerequisite: brcmfmac43430-sdio.bin brcmfmac43430-sdio.txt wpa-supplicant wireless-tools</summary></entry><entry><title type="html">Using Ubuntu-base arm64 rootfs for Raspberry Pi 3</title><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/using-ubuntu-base.html" rel="alternate" type="text/html" title="Using Ubuntu-base arm64 rootfs for Raspberry Pi 3" /><published>2017-05-16T00:00:00+08:00</published><updated>2017-05-16T00:00:00+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/using-ubuntu-base</id><content type="html" xml:base="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/using-ubuntu-base.html">&lt;p&gt;Following my previous &lt;a href=&quot;rpi3-64bit-kernel-and-Uboot-booting-up&quot;&gt;post&lt;/a&gt;, we now can now boot our kernel thru U-boot. 
Now were going to create a filesystem base from arm64 ubuntu base rootfs.&lt;/p&gt;

&lt;p&gt;Create a folder were we will extract the Ubuntu base &lt;a href=&quot;http://cdimage.ubuntu.com/ubuntu-base/releases/16.04.2/release/ubuntu-base-16.04.2-base-arm64.tar.gz&quot;&gt;&lt;b&gt;rootfs&lt;/b&gt;&lt;/a&gt;, and tar to extract.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ mkdir rootfs
$ cd rootfs/
$ sudo tar xzvf ubuntu-base-16.04.2-base-arm64.tar.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;!--more--&gt;
&lt;p&gt;Install the kernel module and firmware into the rootfs folder.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- modules_install INSTALL_MOD_PATH={directory}/rootfs/
$ sudo ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- firmware_install INSTALL_FW_PATH={directory}rootfs/lib/firmware/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Check that it was installed correctly.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ ls rootfs/lib/modules/4.11~

	build               modules.builtin        modules.devname      modules.symbols.bin
	kernel              modules.builtin.bin    modules.order        source
	modules.alias       modules.dep            modules.softdep
	modules.alias.bin   modules.dep.bin        modules.symbols
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Well use &lt;code class=&quot;highlighter-rouge&quot;&gt;chroot&lt;/code&gt; to further setup our filesystem.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -av /usr/bin/qemu-aarch64-static {directory}/rootfs/usr/bin
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h6 id=&quot;or-use-rsync-rsync--azvh-source-destination&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;Or use rsync: rsync -azvh source destination&lt;/h6&gt;

&lt;h6 id=&quot;note&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;Note:&lt;/h6&gt;
&lt;h6 id=&quot;-usrbinqemu-arm-static-is-for-32-bit-armhf-architecture&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;*	/usr/bin/&lt;b&gt;qemu-arm-static&lt;/b&gt; is for 32-bit armhf architecture&lt;/h6&gt;
&lt;h6 id=&quot;-usrbinqemu-aarch64-static-is-for-64-bit-arm64-architecture&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;*	/usr/bin/&lt;b&gt;qemu-aarch64-static&lt;/b&gt; is for 64-bit arm64 architecture&lt;/h6&gt;

&lt;p&gt;Then we need to copy &lt;code class=&quot;highlighter-rouge&quot;&gt;resolv.conf&lt;/code&gt; from our host machine for internet connection to &lt;code class=&quot;highlighter-rouge&quot;&gt;rootfs/etc/&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo cp -av /run/resolvconf/resolv.conf rootfs/etc/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Enter chroot environment:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo chroot {directory}rootfs/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Now that you’re in the chroot environment, we can now add an admin user with sudo permission.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ useradd -G sudo -m -s /bin/bash pi3
$ echo pi3:pi3 | chpasswd
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h6 id=&quot;note-the-format-input-line-of-chpasswd-is-user_namepassword&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;Note: The format input line of chpasswd is: user_name:password.&lt;/h6&gt;

&lt;p&gt;You can setup your &lt;code class=&quot;highlighter-rouge&quot;&gt;hostname&lt;/code&gt; here for your target device or in the kernel configuration making sure that the hostname is empty.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ echo U-Base_min &amp;gt; /etc/hostname
$ echo 127.0.0.1 localhost &amp;gt; /etc/hosts
$ echo 127.0.1.1 U-Base_min &amp;gt;&amp;gt; /etc/hosts
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Fetch the latest package lists from server then upgrade.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ apt-get update
$ apt-get upgrade
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then install these first:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ apt-get install dialog perl
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;We need those installed first to correct some error messages abot locale:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ locale-gen &quot;en_US.UTF-8&quot;
	Generating locales...
  		en_US.UTF-8... done
	Generation complete.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Install minimal packages:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ apt-get install sudo ifupdown net-tools ethtool udev wireless-tools iputils-ping resolvconf wget apt-utils wpasupplicant initramfs-tools
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Create a Ramdisk(optional).&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ mkinitramfs -o /boot/initrd.img /lib/modules/4.11~
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;When everything you want to setup has been done, exit chroot:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ exit
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;To reduce the rootfs/ size we can remove some unwanted files.
Create a file &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/dpkg/dpkg.cfg.d/01_nodoc&lt;/code&gt; which specifies the desired filters. Example:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;path-exclude /usr/share/doc/*
# we need to keep copyright files for legal reasons
path-include /usr/share/doc/*/copyright
path-exclude /usr/share/man/*
path-exclude /usr/share/groff/*
path-exclude /usr/share/info/*
# lintian stuff is small, but really unnecessary
path-exclude /usr/share/lintian/*
path-exclude /usr/share/linda/*
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then you can manually remove any documentation already installed:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo find rootfs/usr/share/doc -depth -type f ! -name copyright|xargs rm || true
$ sudo find rootfs/usr/share/doc -empty|xargs rmdir || true
$ sudo rm -rf rootfs/usr/share/man/* rootfs/usr/share/groff/* rootfs/usr/share/info/*
$ sudo rm -rf rootfs/usr/share/lintian/* rootfs/usr/share/linda/* rootfs/var/cache/man/*
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then copy the &lt;code class=&quot;highlighter-rouge&quot;&gt;rootfs/&lt;/code&gt; content to the 2nd partition of your µSD car. Or you could make an image file with several partition on it. This will create a 2gb empty img file:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo dd if=/dev/zero of=myimage.img bs=1024 count=2M
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then partition it using &lt;code class=&quot;highlighter-rouge&quot;&gt;fdisk&lt;/code&gt; in my case:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo fdisk myimage.img
	Result:
	| Device     | Boot | Start 	| End	  | Sectors |
	|:-----------|:-----|:----------|:--------|:--------|
	| myimage1   |      | 2048  	| 1026047 | 1024000 | Fat
	| myimage2   |      | 1026048 	| 4194303 | 3168256 | Linux
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Display the name of the assigned loop device:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo losetup --find --show myimage.img
	
	/dev/loop0
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;Then we can use &lt;code class=&quot;highlighter-rouge&quot;&gt;fdisk&lt;/code&gt; to identify our image file partitions assinged loop&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo fdisk /dev/loop0

	Device:
		/dev/loop1
		/dev/loop2
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then, to assign a loopback device: and format it.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo losetup /dev/loop1 myimage.img 
$ sudo losetup /dev/loop2 myimage.img
$ sudo mkfs.vfat /dev/loop1
$ sudo mkfs.ext4 /dev/loop2
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h6 id=&quot;mkfsvfat--n-partition-name-devloop1&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;mkfs.vfat -n &lt;code class=&quot;highlighter-rouge&quot;&gt;partition name&lt;/code&gt; /dev/loop1&lt;/h6&gt;

&lt;p&gt;Mount and Copy those necessary files that we need to their respected partition.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo mount /dev/loop1 /mnt/boot
$ sudo mount /dev/loop2 /mnt/rootfs

	then umount and detach:
$ sudo umount /dev/loop1
$ sudo umount /dev/loop2
$ sudo losetup --detach /dev/loop1
$ sudo losetup --detach /dev/loop2
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You can now burn that myimage.img to yor µsd card.
Now boot it up and you should now be able to login.&lt;/p&gt;

&lt;p&gt;Net post will be about setting up the wifi.&lt;/p&gt;

&lt;h5 id=&quot;reference&quot;&gt;&lt;a href=&quot;#header-5&quot;&gt;&lt;/a&gt;Reference:&lt;/h5&gt;
&lt;ul&gt;
  &lt;li&gt;http://docs.khadas.com/social/BuildUbuntuRootfsViaUbuntuBase/&lt;/li&gt;
  &lt;li&gt;https://gnu-linux.org/building-ubuntu-rootfs-for-arm.html&lt;/li&gt;
  &lt;li&gt;http://manpages.ubuntu.com/manpages/xenial/man8/losetup.8.html&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;</content><author><name></name></author><category term="ubuntu" /><summary type="html">Following my previous post, we now can now boot our kernel thru U-boot. Now were going to create a filesystem base from arm64 ubuntu base rootfs. Create a folder were we will extract the Ubuntu base rootfs, and tar to extract. $ mkdir rootfs $ cd rootfs/ $ sudo tar xzvf ubuntu-base-16.04.2-base-arm64.tar.gz</summary></entry><entry><title type="html">Raspberry Pi 3 64bit kernel and U-boot booting up</title><link href="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/rpi3-64bit-kernel-and-Uboot-booting-up.html" rel="alternate" type="text/html" title="Raspberry Pi 3 64bit kernel and U-boot booting up" /><published>2017-05-16T00:00:00+08:00</published><updated>2017-05-16T00:00:00+08:00</updated><id>http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/rpi3-64bit-kernel-and-Uboot-booting-up</id><content type="html" xml:base="http://a-delacruz.github.io/a-DelaCruz.github.io/ubuntu/2017/05/16/rpi3-64bit-kernel-and-Uboot-booting-up.html">&lt;p&gt;Updated, Organized and corrected some typos:&lt;/p&gt;

&lt;h4 id=&quot;cross-build-prerequisite&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;Cross-build prerequisite:&lt;/h4&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcc-arch64-linux-gnu    g++-5                  ncurses-dev
make                    git                    bc          
u-boot-tools            device-tree-compiler   pkg-config-aarch64-linux-gnu
libncurses5-dev
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;!--more--&gt;
&lt;p&gt;Assuming there is already a Cross-build environment: Built on Ubuntu Server 16.04.02&lt;/p&gt;

&lt;h4 id=&quot;prerequisites&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;Prerequisites:&lt;/h4&gt;
&lt;ul&gt;
  &lt;li&gt;Ubuntu Base &lt;a href=&quot;http://cdimage.ubuntu.com/ubuntu-base/releases/16.04.2/release/ubuntu-base-16.04.2-base-arm64.tar.gz&quot;&gt;Rootfs&lt;/a&gt; (install additional package using apt-get)&lt;/li&gt;
  &lt;li&gt;Raspberry pi &lt;a href=&quot;https://github.com/raspberrypi/linux.git&quot;&gt;kernel&lt;/a&gt; (Have not tried using Upstream kernel)&lt;/li&gt;
  &lt;li&gt;Raspberry pi &lt;a href=&quot;https://github.com/raspberrypi/firmware/tree/master/boot&quot;&gt;firmware&lt;/a&gt;(bootcode.bin, start.elf, fixup.dat as this are the min. files to boot)&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.denx.de/wiki/U-Boot/WebHome&quot;&gt;U-boot&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;µsd-card-assuming-you-already-know-how-to-partition-it&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;µSD card: &lt;code class=&quot;highlighter-rouge&quot;&gt;(assuming you already know how to partition it)&lt;/code&gt;&lt;/h4&gt;

&lt;p&gt;Your µSD card(fat partition 1) should contain the following:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/boot
bootcode.bin
start.elf 
fixup.dat 
config.txt
cmdline.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h6 id=&quot;note-boot-sub-folder-will-contain-our-u-boot-file-kernel-and-initrd-image-file&quot;&gt;&lt;a href=&quot;#header-6&quot;&gt;&lt;/a&gt;Note: &lt;code class=&quot;highlighter-rouge&quot;&gt;/boot&lt;/code&gt; sub-folder will contain our U-Boot file, Kernel and Initrd image file.&lt;/h6&gt;

&lt;p&gt;For the &lt;code class=&quot;highlighter-rouge&quot;&gt;config.txt&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;cmdline.txt&lt;/code&gt;, we have to create them and include this lines.&lt;/p&gt;

&lt;h5 id=&quot;configtxt&quot;&gt;&lt;a href=&quot;#header-5&quot;&gt;&lt;/a&gt;config.txt:&lt;/h5&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;arm_control=0x200
force_turboo=1
enable_uart=1
device_tree_address=0x100
device_tree_end=0x8000
kernel=boot/kernel8.img
dtparam=i2c_arm=on
dtparam=spi=on
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h5 id=&quot;cmdlinetxt&quot;&gt;&lt;a href=&quot;#header-5&quot;&gt;&lt;/a&gt;cmdline.txt:&lt;/h5&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;net.ifnames=0 dwc_otg.lpm_enable=0 console=ttyAMA0,115200 console=tty1 root=/dev/mmcblk0p2 rootfstype=ext4 elevator=deadline fsck.repair=yes rootwait
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;h4 id=&quot;u-boot&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;U-Boot:&lt;/h4&gt;
&lt;p&gt;Get the source code by cloning the U-Boot git repository or download the tar file.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone depth 1 branch v2017.03 single-branch git://git.denx.de/u-boot.git
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;or download:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ftp://ftp.denx.de/pub/u-boot/u-boot-2017.03.tar.bz2
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then configure and build u-boot. For 64-bit use &lt;code class=&quot;highlighter-rouge&quot;&gt;rpi_3_defconfig&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd u-boot/
$ sudo make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- rpi_3_defconfig
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Then compile it.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu-
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;To change output directory use &lt;code class=&quot;highlighter-rouge&quot;&gt;O=Output path/&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ sudo make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- O=Output path/
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;After it has been built. Locate &lt;code class=&quot;highlighter-rouge&quot;&gt;u-boot.bin&lt;/code&gt; in your output_path as this is the file we need. 
Copy it to your µSD card inside &lt;code class=&quot;highlighter-rouge&quot;&gt;/boot folder&lt;/code&gt; and rename it to &lt;code class=&quot;highlighter-rouge&quot;&gt;kernel8.img&lt;/code&gt; or keep its name as is in config.txt. 
Boot it up to confirm that its working.&lt;/p&gt;

&lt;h4 id=&quot;kernel&quot;&gt;&lt;a href=&quot;#header-4&quot;&gt;&lt;/a&gt;Kernel:&lt;/h4&gt;
&lt;p&gt;Get the kernel source code at the official Raspberry pi git repository.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ git clone depth 1 branch v2017.03 single-branch https://github.com/raspberrypi/linux.git
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;bcmrpi3_defconfig&lt;/code&gt; for kernel config. 
You can further configure it according to your needs. But for now, its fine to leave it be.
You can also change the output directory using: &lt;code class=&quot;highlighter-rouge&quot;&gt;O=Output_path/&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ cd linux
$ sudo make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- bcmrpi3_defconfig
$ sudo make ARCH=arm64 CROSS_COMPILE=aarch64-linux-gnu- -j3
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Locate &lt;code class=&quot;highlighter-rouge&quot;&gt;Image&lt;/code&gt; (no need to convert for U-Boot use it as it is for 64bit) file at your output_path/ &lt;code class=&quot;highlighter-rouge&quot;&gt;arch/arm64/boot/&lt;/code&gt; 
and the &lt;code class=&quot;highlighter-rouge&quot;&gt;bcm2710-rpi-3-b.dtb&lt;/code&gt; at &lt;code class=&quot;highlighter-rouge&quot;&gt;arch/arm/boot/dts/&lt;/code&gt;. I encounter problem using 
&lt;code class=&quot;highlighter-rouge&quot;&gt;bcm2837-rpi-3-b.dtb&lt;/code&gt;. So for now use &lt;code class=&quot;highlighter-rouge&quot;&gt;bcm2710-rpi-3-b.dtb&lt;/code&gt; instead. 
Copy the &lt;code class=&quot;highlighter-rouge&quot;&gt;Image&lt;/code&gt; in &lt;code class=&quot;highlighter-rouge&quot;&gt;/boot folder&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;bcm2710-rpi-3-b.dtb&lt;/code&gt; in the upper most directory of your µSD card.
It should look like this:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/boot/Image
/boot/kernel8.img
bcm2710-rpi-3-b.dtb
bootcode.bin
start.elf 
fixup.dat 
config.txt
cmdline.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;At this point, you can test it if it will boot the kernel but we need to have a boot script that U-Boot needs. 
Were using the boot.script from this file: &lt;a href=&quot;https://www.finnie.org/software/raspberrypi/ubuntu-rpi3/20160517-raspi3-arm64-firmware-kernel.tar.xz&quot;&gt;&lt;b&gt;20160517-raspi3-arm64-firmware-kernel.tar.xz&lt;/b&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Modify and create the &lt;code class=&quot;highlighter-rouge&quot;&gt;boot.scr&lt;/code&gt; from it.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ mkimage -A arm64 -O linux -T script -d /path/to/boot.script /path/where/you/want/to/save
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;boot.script&lt;/code&gt; should look like this: and place it inside hte &lt;code class=&quot;highlighter-rouge&quot;&gt;/boot&lt;/code&gt; folder.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;fdt addr 0x100
fdt get value bootargs /chosen bootargs
setenv kernel_addr_r 0x01000000
setenv ramdisk_addr_r 0x02100000
fatload mmc 0:1 ${kernel_addr_r} boot/Image
fatload mmc 0:1 ${ramdisk_addr_r} boot/initrd.img
setenv initrdsize $filesize
fatload mmc 0:1 ${fdt_addr_r} bcm2710-rpi-3-b.dtb
booti ${kernel_addr_r} ${ramdisk_addr_r}:${initrdsize} ${fdt_addr_r}
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Since we dont have a Ramdisk yet, comment that line and replace &lt;code class=&quot;highlighter-rouge&quot;&gt;${ramdisk_addr_r}:${initrdsize}&lt;/code&gt; with &lt;code class=&quot;highlighter-rouge&quot;&gt;-&lt;/code&gt;.
Or copy the &lt;code class=&quot;highlighter-rouge&quot;&gt;initrd.img&lt;/code&gt; to use it temporarily.&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/boot/Image
/boot/boot.scr
/boot/kernel8.img
/boot/initrd.img
bcm2710-rpi-3-b.dtb
bootcode.bin
start.elf 
fixup.dat 
config.txt
cmdline.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;p&gt;You can now then verify at this point that our kernel boot as well and will stop at some point 
since we still do not have a filesystem.&lt;/p&gt;

&lt;p&gt;Next post will be about on how to make a filesystem base on Ubuntu Base.&lt;/p&gt;

&lt;h5 id=&quot;reference&quot;&gt;&lt;a href=&quot;#header-5&quot;&gt;&lt;/a&gt;Reference:&lt;/h5&gt;
&lt;ul&gt;
  &lt;li&gt;https://wiki.ubuntu.com/ARM/RaspberryPi/RaspberryPi3”&lt;/li&gt;
  &lt;li&gt;https://wiki.ubuntu.com/Base&lt;/li&gt;
  &lt;li&gt;https://www.raspberrypi.org/documentation/linux/kernel/building.md&lt;/li&gt;
  &lt;li&gt;https://kernelnomicon.org/?p=682&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;</content><author><name></name></author><category term="ubuntu" /><summary type="html">Updated, Organized and corrected some typos: Cross-build prerequisite: gcc-arch64-linux-gnu g++-5 ncurses-dev make git bc u-boot-tools device-tree-compiler pkg-config-aarch64-linux-gnu libncurses5-dev</summary></entry></feed>